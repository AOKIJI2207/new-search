<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Moteur d’actualité — recherche par mots-clés</title>
  <style>
    :root{--bg:#0b0f17;--card:#121a29;--text:#e7ecf5;--muted:#a9b4c7;--border:rgba(255,255,255,.10);--accent:#6aa6ff;--glow:rgba(106,166,255,.25)}
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;
      color:var(--text);
      background:
        radial-gradient(900px 480px at 10% -10%, rgba(106,166,255,.25), transparent 60%),
        radial-gradient(700px 420px at 90% 0%, rgba(106,166,255,.18), transparent 60%),
        linear-gradient(180deg,#070a12,#0b0f17);
      background-attachment: fixed;
    }
    body::before{
      content:"";
      position:fixed;
      inset:0;
      background-image:url("data:image/jpeg;base64,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");
      background-size: cover;
      background-position: center;
      opacity: 0.6;
      filter: contrast(1.15) saturate(1.15);
      pointer-events: none;
      z-index: -1;
    }
    header{position:sticky;top:0;z-index:10;backdrop-filter:blur(10px);background:rgba(11,15,23,.75);border-bottom:1px solid var(--border)}
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    h1{margin:0;font-size:18px}
    .sub{margin-top:6px;color:var(--muted);font-size:13px;line-height:1.35}
    main{display:grid;grid-template-columns:1.6fr .9fr;gap:14px;padding:14px 16px 32px;max-width:1100px;margin:0 auto}
    @media(max-width:980px){main{grid-template-columns:1fr}}
    .panel{background:rgba(18,26,41,.45);border:1px solid rgba(255,255,255,.14);border-radius:16px;overflow:hidden;box-shadow:0 20px 40px rgba(0,0,0,.25);backdrop-filter:blur(6px)}
    .hd{display:flex;gap:10px;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid var(--border);flex-wrap:wrap}
    .bd{padding:12px}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    input,textarea,button{background:#0c1220;color:var(--text);border:1px solid var(--border);padding:10px 11px;border-radius:12px;font:inherit}
    button{cursor:pointer}
    button.primary{background:linear-gradient(180deg,rgba(106,166,255,.25),rgba(106,166,255,.12));border-color:rgba(106,166,255,.35);box-shadow:0 10px 20px rgba(106,166,255,.15)}
    .badge{font-size:12px;color:var(--muted);border:1px solid var(--border);padding:6px 10px;border-radius:999px}
    .articles{display:grid;gap:10px}
    article{background:rgba(12,18,32,.38);border:1px solid rgba(255,255,255,.14);border-radius:14px;padding:12px}
    article h3{margin:0 0 6px 0;font-size:15px;line-height:1.25}
    .idx{display:inline-flex;align-items:center;justify-content:center;min-width:22px;height:22px;border-radius:999px;background:rgba(106,166,255,.15);border:1px solid rgba(106,166,255,.35);color:#cfe1ff;font-size:12px;margin-right:8px}
    .meta{display:flex;gap:10px;flex-wrap:wrap;align-items:center;color:var(--muted);font-size:12px}
    .snippet{margin-top:8px;color:#d7def0;line-height:1.45;font-size:14px}
    a{color:#cfe1ff}
    .chat{display:flex;flex-direction:column;height:72vh;min-height:520px}
    .chatlog{flex:1;overflow:auto;padding:12px;display:flex;flex-direction:column;gap:10px}
    .msg{max-width:92%;padding:10px;border-radius:14px;border:1px solid rgba(255,255,255,.14);background:rgba(12,18,32,.38)}
    .msg.user{align-self:flex-end;border-color:rgba(106,166,255,.35)}
    .who{font-size:12px;color:var(--muted);margin-bottom:6px}
    .txt{white-space:pre-wrap;line-height:1.4;font-size:14px}
    .cites{margin-top:8px;font-size:12px;color:var(--muted)}
    .small{font-size:12px;color:var(--muted);line-height:1.35}
    .sources{display:flex;flex-wrap:wrap;gap:10px}
    .src{display:flex;gap:8px;align-items:center;font-size:13px;color:var(--muted)}
    .toggle{display:flex;gap:8px;align-items:center;font-size:13px;color:var(--muted);background:rgba(12,18,32,.6);border:1px solid var(--border);padding:6px 10px;border-radius:999px}
    .source-actions{display:flex;gap:8px;flex-wrap:wrap}
    .ghost{background:transparent;border:1px dashed var(--border);color:var(--muted)}
    .idx{display:inline-flex;align-items:center;justify-content:center;min-width:22px;height:22px;border-radius:999px;background:rgba(106,166,255,.15);border:1px solid rgba(106,166,255,.35);color:#cfe1ff;font-size:12px;margin-right:8px}
  </style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>Moteur d’actualité — recherche par mots-clés</h1>
    <div class="sub">Tape un mot-clé (ex: “Groenland”, “cybersécurité”, “OTAN”). Résultats issus de flux RSS ouverts. Si aucune source n’est cochée, la recherche utilise toutes les sources.</div>
  </div>
</header>

<main>
  <section class="panel">
    <div class="hd">
      <div class="row">
        <span class="badge" id="status">Prêt</span>
        <span class="small" id="count"></span>
      </div>
      <div class="row">
        <input id="q" type="search" placeholder='Ex: Groenland | cybersécurité | OTAN arctique' style="min-width:280px"/>
        <button class="primary" id="searchBtn">Rechercher</button>
      </div>
    </div>

    <div class="bd">
      <div class="row source-actions">
        <button class="ghost" id="selectAll">Tout sélectionner</button>
        <button class="ghost" id="clearAll">Tout désélectionner</button>
        <label class="toggle">
          <input type="checkbox" id="toggleSources" checked />
          Afficher les sources
        </label>
      </div>
      <div style="height:8px"></div>
      <div class="sources" id="sourceToggles"></div>
      <div style="height:10px"></div>
      <div class="articles" id="articles"></div>
    </div>
  </section>

  <aside class="panel chat">
    <div class="hd">
      <div class="row">
        <span class="badge">Chatbot</span>
        <span class="small">réponses sourcées</span>
      </div>
      <button class="primary" id="reset">Réinitialiser</button>
    </div>

    <div class="chatlog" id="chatlog"></div>

    <div class="bd" style="padding-top:0">
      <div class="row">
        <textarea id="prompt" placeholder="Ex : résume les infos majeures" style="flex:1; height:44px"></textarea>
        <button class="primary" id="send">Envoyer</button>
      </div>
      <div class="small" style="margin-top:10px">Astuce : demande “résume les articles”, “résume l’article #3”, “cite tes sources”.</div>
    </div>
  </aside>
</main>

<script>
  const $ = s => document.querySelector(s);
  const escapeHtml = s => (s ?? "").replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  const norm = s => (s||"").toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/[^a-z0-9\\s-]/g," ").replace(/\\s+/g," ").trim();
  const tokenize = s => norm(s).split(" ").filter(t=>t.length>=2);

  let SOURCES = [];
  let selected = new Set();
  let ITEMS = [];

  async function loadSources(){
    const r = await fetch("/api/sources");
    SOURCES = await r.json();
    selected = new Set(SOURCES.filter(s=>s.enabledByDefault).map(s=>s.key));
    renderSourceToggles();
    setStatus("Prêt");
  }

  function renderSourceToggles(){
    const root = $("#sourceToggles");
    root.innerHTML = SOURCES.map(s => `
      <label class="src">
        <input type="checkbox" data-key="${escapeHtml(s.key)}" ${selected.has(s.key) ? "checked":""}/>
        ${escapeHtml(s.name)}
      </label>
    `).join("");
    root.querySelectorAll("input[type=checkbox]").forEach(cb=>{
      cb.addEventListener("change", e=>{
        const k = e.target.getAttribute("data-key");
        if(e.target.checked) selected.add(k); else selected.delete(k);
      });
    });
  }

  function setStatus(text){ $("#status").textContent = text; }

  async function search(){
    const q = $("#q").value.trim();
    if(selected.size === 0){
      setStatus("Choisis au moins 1 source");
      return;
    }
    setStatus("Recherche…");
    $("#count").textContent = "";

    const keys = Array.from(selected).join(",");
    const r = await fetch(`/api/search?q=${encodeURIComponent(q)}&sources=${encodeURIComponent(keys)}`);
    const data = await r.json();

    if(data.error){
      setStatus("Erreur");
      const details = data.warnings?.length
        ? ` (${data.warnings.length} source(s) en échec)`
        : "";
      $("#articles").innerHTML = `<div class="small">${escapeHtml(data.error)}${escapeHtml(details)} ${escapeHtml(data.details||"")}</div>`;
      return;
    }

    ITEMS = data.items || [];
    const warningText = data.warnings?.length
      ? ` — ${data.warnings.length} source(s) en échec`
      : "";
    setStatus(`Résultats pour: ${q || "tout"}${warningText}`);
    $("#count").textContent = `${ITEMS.length} item(s)`;
    renderArticles();
  }

  function renderArticles(){
    const root = $("#articles");
    root.innerHTML = ITEMS.map((it, idx) => `
      <article>
        <h3><span class="idx">#${idx + 1}</span><a href="${escapeHtml(it.link)}" target="_blank" rel="noopener noreferrer">${escapeHtml(it.title)}</a></h3>
        <div class="meta">
          <span>${escapeHtml(it.sourceName)}</span>
          <span>•</span>
          <span>${escapeHtml(it.pubDate ? new Date(it.pubDate).toLocaleString("fr-FR") : "")}</span>
        </div>
        <div class="snippet">${escapeHtml(it.snippet || "")}</div>
      </article>
    `).join("") || `<div class="small">Aucun résultat. Essaie un autre mot-clé (ex: “arctic”, “nato”, “ransomware”).</div>`;
  }

  // Chatbot: répond UNIQUEMENT depuis ITEMS
  const chat = { messages: [
    { role:"assistant", text:"Je peux répondre de façon générale comme un chat classique. Pour des réponses sourcées, lance une recherche puis demande un résumé global ou un article (#)." }
  ]};

  function renderChat(){
    const log = $("#chatlog");
    log.innerHTML = chat.messages.map(m => `
      <div class="msg ${m.role==="user" ? "user":""}">
        <div class="who">${m.role==="user" ? "Toi":"Chatbot"}</div>
        <div class="txt">${escapeHtml(m.text)}</div>
        ${m.cites?.length ? `<div class="cites">Sources: ${
          m.cites.map(c => `${escapeHtml(c.sourceName)} — ${escapeHtml(c.title)}`).join(" | ")
        }</div>` : ""}
      </div>
    `).join("");
    log.scrollTop = log.scrollHeight;
  }

  function score(it, qTokens){
    const hay = tokenize([it.title, it.snippet, it.sourceName].join(" ")).join(" ");
    let s = 0;
    for(const t of qTokens){
      const re = new RegExp("\\\\b"+t+"\\\\b","g");
      s += (hay.match(re)||[]).length;
    }
    return s;
  }

  function topMatches(question, k=8){
    const qTokens = tokenize(question);
    if(qTokens.length===0) return [];
    return ITEMS
      .map(it => ({it, s: score(it, qTokens)}))
      .filter(x=>x.s>0)
      .sort((a,b)=>b.s-a.s)
      .slice(0,k);
  }

  function extractArticleIndex(question){
    const match = question.match(/#(\\d+)/);
    if (!match) return null;
    const idx = Number.parseInt(match[1], 10);
    if (Number.isNaN(idx) || idx < 1 || idx > ITEMS.length) return null;
    return idx - 1;
  }

  function genericAnswer(question){
    const qn = norm(question);
    const title = question.trim() ? `Sujet : ${question.trim()}` : "Sujet : (non précisé)";
    const isSummary = qn.includes("resume") || qn.includes("synthese");
    const isHow = qn.includes("comment");
    const isWhy = qn.startsWith("pourquoi");
    const isWhen = qn.startsWith("quand");
    const isWhat = qn.startsWith("quoi") || qn.startsWith("quest ce que") || qn.startsWith("qu est ce que");

    const lines = [];
    lines.push("Réponse générale (non sourcée) :");
    lines.push(`- ${title}`);
    if (isSummary) {
      lines.push("- Résumé : je peux faire une synthèse générale. Pour une synthèse sourcée d’articles, lance une recherche.");
    } else if (isHow) {
      lines.push("- Méthode : étapes clés, bonnes pratiques, points de vigilance.");
    } else if (isWhy) {
      lines.push("- Causes possibles : facteurs principaux, contexte, impacts.");
    } else if (isWhen) {
      lines.push("- Chronologie : repères temporels et conditions qui influencent le timing.");
    } else if (isWhat) {
      lines.push("- Définition : explication claire, exemples simples.");
    } else {
      lines.push("- Points clés : notions centrales, avantages/limites, exemples.");
    }
    lines.push("Si tu veux des sources vérifiables, lance une recherche et je m’appuierai sur les articles.");
    return lines.join("\\n");
  }

  function buildAnswer(question){
    if(ITEMS.length===0){
      return { text: genericAnswer(question), cites:[] };
    }
    const matches = topMatches(question, 10);
    if(matches.length===0){
      return { text:"Je ne trouve rien dans les résultats chargés qui corresponde. Reformule ou refais une recherche plus large.", cites:[] };
    }

    const qn = norm(question);
    const wantsSummary = qn.includes("resume") || qn.includes("synthese") || qn.includes("maj") || qn.includes("principales");
    const wantsSources = qn.includes("source") || qn.includes("cite");
    const articleIndex = extractArticleIndex(question);
    const wantsArticleSummary = articleIndex !== null && (qn.includes("resume") || qn.includes("resumer"));

    const lines = [];
    if(wantsArticleSummary){
      const it = ITEMS[articleIndex];
      lines.push(`Résumé de l’article #${articleIndex + 1} (${it.sourceName}) :`);
      lines.push(`- Titre : ${it.title}`);
      if (it.snippet) lines.push(`- Extrait : ${it.snippet}`);
      lines.push(`- Lien : ${it.link}`);
      return { text: lines.join("\\n"), cites: [it] };
    }
    if(wantsSummary){
      lines.push("Synthèse basée sur les résultats chargés :");
      for(const {it} of matches.slice(0,5)) lines.push(`- ${it.sourceName} : ${it.title}`);
    } else if(wantsSources){
      lines.push("Sources pertinentes dans les résultats :");
      for(const {it} of matches.slice(0,6)) lines.push(`- ${it.sourceName} : ${it.title}`);
    } else {
      lines.push("Éléments les plus proches de ta question :");
      for(const {it} of matches.slice(0,4)) lines.push(`- ${it.sourceName} : ${it.title}`);
      lines.push("");
      lines.push("Si tu veux, je peux faire une synthèse thématique (géopolitique / économie / cyber / défense).");
    }

    return { text: lines.join("\\n"), cites: matches.slice(0,6).map(x=>x.it) };
  }

  function send(){
    const q = $("#prompt").value.trim();
    if(!q) return;
    chat.messages.push({ role:"user", text:q });
    const ans = buildAnswer(q);
    chat.messages.push({ role:"assistant", text: ans.text, cites: ans.cites });
    $("#prompt").value = "";
    renderChat();
  }

  $("#searchBtn").addEventListener("click", search);
  $("#selectAll").addEventListener("click", () => {
    selected = new Set(SOURCES.map(s => s.key));
    renderSourceToggles();
  });
  $("#clearAll").addEventListener("click", () => {
    selected = new Set();
    renderSourceToggles();
  });
  $("#toggleSources").addEventListener("change", e => {
    $("#sourceToggles").style.display = e.target.checked ? "flex" : "none";
  });
  $("#q").addEventListener("keydown", e => {
    if(e.key === "Enter"){ e.preventDefault(); search(); }
  });
  $("#send").addEventListener("click", send);
  $("#reset").addEventListener("click", () => {
    chat.messages = [{ role:"assistant", text:"Chat réinitialisé. Fais une recherche puis pose ta question." }];
    renderChat();
  });

  renderChat();
  loadSources();
</script>
</body>
</html>
